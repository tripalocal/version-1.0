{% extends "app/layout.html" %}
{% load mathfilters %}
{% load i18n %}

{% block head %}
    {% load staticfiles %}
    <title>{{ itinerary.title }}</title>
    <link href="{% static 'experiences/content/itinerary-detail.css' %}" rel="stylesheet"/>
{% endblock %}

{% block content %}
{% if itinerary.status == "paid" %}
<div class="paid-banner">
  <p>{% trans 'You have successfully booked this itinerary!' %}</p>
</div>
{% endif %}
<div class="jumbotron">
  <h1>{{ itinerary.title }}</h1>
</div>

<div class="container">
  <div class="booking-box">
    <form method="post" action="{{GEO_POSTFIX}}itinerary/{{itinerary_id}}/">
        {% csrf_token %}
        <div class="row">
          <p>{{ itinerary.days|length }} Day {{ guest_number }} Adult Custom Itinerary</p>
          <p>{{start_date}} to {{end_date}}</p>
        </div>
        {% if itinerary.status != "draft" and itinerary.status != "paid" %}
        <div class="row">
          <h1 style="margin:0;">${{price}}</h1>
        </div>
        <div class="booking-tip" style="display:none;">
          <img src="{% static 'experiences/img/time2.svg' %}" width="45" height="45">
          <p>{% trans 'Hurry, more than 50&#37; of this tour has been booked within the next 6 months' %}</p>
        </div>
        <div>
            {% if user.is_authenticated %}
            <button id="pay" class="btn btn-primary"><img src="{% static 'icon/coins_white.svg' %}" style="margin-right:10px;">{%trans "Pay"%}</button>
            {% else %}
            <input class="btn btn-primary" type="button" value="{%trans "Pay"%}" onclick="location.href = '{{GEO_POSTFIX}}accounts/login/?next={{GEO_POSTFIX}}itinerary/{{itinerary_id}}';"/>
            {% endif %}
        </div>
        {% endif %}
    </form>
  </div>

  <div class="detail-box">
    <ul class="timeline">
      {% for day in itinerary.days.items %}
      <li class="day-nav" id="day{{ forloop.counter }}">D{{ forloop.counter }}</li>
      {% endfor %}
    </ul>
    {%for date, list in itinerary.days.items %}
    <div class="day-list" id="day{{forloop.counter}}-list">
      <h3 class="day-heading">Day {{forloop.counter}} {{date}} {{list.0.city}} </h3>
      {% for item in list %}
        <div class="item-heading">
          <span class="item-icon">
            {% if item.type == 'PrivateProduct' or item.type == 'PublicProduct' or item.type == 'PRIVATE' or item.type == 'NONPRIVATE' %}
            <img src="{% static 'experiences/img/hot-56.svg' %}">
            {% elif item.type == 'Flight' %}
            <img src="{% static 'experiences/img/flight.svg' %}">
            {% elif item.type == 'Transfer' %}
            <img src="{% static 'experiences/img/transfer.svg' %}">
            {% elif item.type == 'Accommodation' %}
            <img src="{% static 'experiences/img/accommodation.svg' %}">
            {% elif item.type == 'Restaurant' %}
            <img src="{% static 'experiences/img/restaurant.svg' %}">
            {% elif item.type == 'Suggestion' %}
            <img src="{% static 'experiences/img/itinerary.svg' %}">
            {% endif %}
          </span>
          <p>{{item.title}}</p>
        </div>
        {% with item.photo_set.all|first as photo %}
        <div class="item-img"><img src="{{ MEDIA_URL }}{{photo.directory}}{{photo.name}}"></div>
        {% endwith %}
        <div class="item-description"><p>{{item.description}}</p></div>
      {% endfor %}
    </div>
    {% endfor %}
  </div>
</div>



{% endblock %}

{% block scripts %}
<script type="text/javascript" src="//code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {
  if ($(window).width() > 760) {
    $(".day-nav").click(function() {
      var $day = $(this);
      $(".day-nav").removeClass("active");
      $day.addClass("active");
      $(".day-list").hide();
      $("#" + $day.attr("id") + "-list").fadeIn();
    });
    $("#day1").click();
  }
  {% if itinerary.status == "paid" %}
  $(".paid-banner").delay(10000).slideUp();
  {% endif %}
  $("#pay").click(function(e){

  });
})
</script>
{% endblock %}
