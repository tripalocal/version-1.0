<html>
<head>
    {% load staticfiles %}
    <title>Create/Edit Experience</title>
    
    <script language="javascript" type="text/javascript" src="{% static 'app/scripts/jquery-1.10.2.js' %}"></script>
    <script language="javascript" type="text/javascript" src="{% static 'app/scripts/bootstrap.js' %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'app/content/bootstrap.css' %}" />
    <link href="{% static 'app/content/globalReset.css' %}" rel="stylesheet">
    <link href="{% static 'app/content/browserStyle.css' %}" rel="stylesheet">
    <link href="{% static 'app/content/bootstrap-datetimepicker.css' %}" rel="stylesheet">
    {% if form %}
        {{ form.media }}
    {% endif %}

    <style>
    .fileUpload {
	    position: relative;
	    overflow: hidden;
	    margin: 10px;
        width:120px;
        height:35px;
    }
    .fileUpload input.upload {
	    position: absolute;
	    top: 0;
	    right: 0;
	    margin: 0;
	    padding: 0;
	    font-size: 20px;
	    cursor: pointer;
	    opacity: 0;
	    filter: alpha(opacity=0);
    }
    input.uploadImage {
        width:150px;
        height:35px;
    }
    </style>

</head>
<body>
{% if user.is_authenticated and user.is_staff  %}
    <div class="container">
        <div class="leftColumn">
            <div class="operation"></div>
            <ul class="subMenu">
                <li>Add new experience</li>
            </ul>
            <div class="clear"></div>
            <div>
                {% if form.errors and display_error%}
                    <p style="color:red">The following fields are required</p>
                    {% for error in form.errors %}
                        <p>{{error}}</p>
                    {% endfor %}
                {% endif %}
            </div>
            <form id="create_experience_form" method="post" action="" enctype="multipart/form-data">
                {% csrf_token %}
                <table border="0" cellspacing="0" cellpadding="0">
                    <tr>
                        <td class="coRight">ID</td>
                        <td colspan="1">{{form.id}}</td>
                    </tr>
                    <tr>
                        <td class="coRight">Host</td>
                        <td colspan="1">{{form.host}}</td>
                    </tr>
                    <tr>
                        <td class="coRight">Status</td>
                        <td colspan="1">{{form.status}}</td>
                    </tr>
                    <tr>
                        <td class="coRight">Language</td>
                        <td colspan="1">{{form.language}}</td>
                    </tr>
                    <tr>
                        <td class="coRight">Start from</td>
                        <td colspan="1">{{form.start_datetime}}</td>
                    </tr>
                    <tr>
                        <td class="coRight">Until</td>
                        <td colspan="1">{{form.end_datetime}}</td>
                    </tr>
<!--
                    <tr>
                        <td class="coRight">Repeats</td>
                        <td colspan="1">{{form.repeat_cycle}}</td>
                    </tr>
                    <tr>
                        <td class="coRight">Repeat every</td>
                        <td colspan="1">{{form.repeat_frequency}} <label id="repeat_frequency_label"></label></td>
                    </tr>
-->
                    <tr>
                        <td class="coRight">Title</td>
                        <td colspan="3">{{form.title}}</td>
                    </tr>
                    <tr>
                        <td class="coRight">Summary</td>
                        <td colspan="3">{{form.summary}}</td>
                    </tr>
                    <tr>
                        <td class="coRight">Group size</td>
                        <td colspan="1"><label>Min </label>{{form.guest_number_min}} {{form.guest_number_max}}<label> Max</label></td>
                    </tr>
                    <tr>
                        <td class="coRight">Pricing</td>
                        <td colspan="2">
                            <label>Traveler pays ${{form.price_with_booking_fee}} - fee = Host gets ${{form.price}}
                            <br />
                            </label>
                        </td>
                    </tr>
                    <tr>
                        <td class="coRight">Duration</td>
                        <td colspan="2">
                            <label>{{form.duration}}Hours 
                            <br />
                            </label>
                        </td>
                    </tr>
                    <tr>
                        <td class="coRight">What's included</td>
                        <td colspan="2">
                            <table  border="0" cellspacing="0" cellpadding="0">
                                <tr>
                                  <td>&nbsp;</td>
                                  <td>Yes / No</td>
                                  <td>Detail</td>
                                </tr>
                                <tr>
                                    <td>Food</td>
                                    <td>{{form.included_food}}</td>
                                    <td>{{form.included_food_detail}}</td>
                                </tr>
                                <tr>
                                    <td>Transport</td>
                                    <td>{{form.included_transport}}</td>
                                    <td>{{form.included_transport_detail}}</td>
                                </tr>
                                <tr>
                                    <td>Ticket</td>
                                    <td>{{form.included_ticket}}</td>
                                    <td>{{form.included_ticket_detail}}</td>
                                </tr>
                            </table>
                            <label><br /></label>
                        </td>
                    </tr>
                    <tr>
                        <td class="coRight">What sort of activities would you offer on your experience?</td>
                        <td colspan="2">{{form.activity}}</td>
                    </tr>
                    <tr>
                        <td class="coRight">How would you interact with your guests?</td>
                        <td colspan="2">{{form.interaction}}</textarea></td>
                    </tr>
                    <tr>
                        <td class="coRight">Appropriate dress code</td>
                        <td colspan="2">{{form.dress_code}}</td>
                    </tr>
                    <tr>
                        <td class="coRight">Suburb</td>
                        <td colspan="2">{{form.suburb}}</td>
                    </tr>
                    <tr>
                        <td class="coRight">Meet up spot (Meet up direction for confirmed guest)</td>
                        <td colspan="2">{{form.meetup_spot}}</textarea></td>
                    </tr>
                    <tr>
                        <td class="coRight">Experience photo</td>
                        <td colspan="2">
                            {%if form.files.experience_photo_1%}
                            <input id="uploadImage_1" placeholder="{{form.files.experience_photo_1.name}}" class="uploadImage" disabled="disabled" />
                            {%else%}
                            <input id="uploadImage_1" placeholder="No file chosen" class="uploadImage" disabled="disabled" />
                            {%endif%}
                            <div class="fileUpload btn btn-primary">
                                <span>Choose File</span>
                                {{form.experience_photo_1}}
                            </div>
                            <br>
                            {%if form.files.experience_photo_2%}
                            <input id="uploadImage_2" placeholder="{{form.files.experience_photo_2.name}}" class="uploadImage" disabled="disabled" />
                            {%else%}
                            <input id="uploadImage_2" placeholder="No file chosen" class="uploadImage" disabled="disabled" />
                            {%endif%}
                            <div class="fileUpload btn btn-primary">
                                <span>Choose File</span>
                                {{form.experience_photo_2}}
                            </div>
                            <br>
                            {%if form.files.experience_photo_3%}
                            <input id="uploadImage_3" placeholder="{{form.files.experience_photo_3.name}}" class="uploadImage" disabled="disabled" />
                            {%else%}
                            <input id="uploadImage_3" placeholder="No file chosen" class="uploadImage" disabled="disabled" />
                            {%endif%}
                            <div class="fileUpload btn btn-primary">
                                <span>Choose File</span>
                                {{form.experience_photo_3}}
                            </div>
                            <br>
                            {%if form.files.experience_photo_4%}
                            <input id="uploadImage_4" placeholder="{{form.files.experience_photo_4.name}}" class="uploadImage" disabled="disabled" />
                            {%else%}
                            <input id="uploadImage_4" placeholder="No file chosen" class="uploadImage" disabled="disabled" />
                            {%endif%}
                            <div class="fileUpload btn btn-primary">
                                <span>Choose File</span>
                                {{form.experience_photo_4}}
                            </div>
                            <br>
                            {%if form.files.experience_photo_5%}
                            <input id="uploadImage_5" placeholder="{{form.files.experience_photo_5.name}}" class="uploadImage" disabled="disabled" />
                            {%else%}
                            <input id="uploadImage_5" placeholder="No file chosen" class="uploadImage" disabled="disabled" />
                            {%endif%}
                            <div class="fileUpload btn btn-primary">
                                <span>Choose File</span>
                                {{form.experience_photo_5}}
                            </div>
                            <br>
                            {%if form.files.experience_photo_6%}
                            <input id="uploadImage_6" placeholder="{{form.files.experience_photo_6.name}}" class="uploadImage" disabled="disabled" />
                            {%else%}
                            <input id="uploadImage_6" placeholder="No file chosen" class="uploadImage" disabled="disabled" />
                            {%endif%}
                            <div class="fileUpload btn btn-primary">
                                <span>Choose File</span>
                                {{form.experience_photo_6}}
                            </div>
                            <br>
                            {%if form.files.experience_photo_7%}
                            <input id="uploadImage_7" placeholder="{{form.files.experience_photo_7.name}}" class="uploadImage" disabled="disabled" />
                            {%else%}
                            <input id="uploadImage_7" placeholder="No file chosen" class="uploadImage" disabled="disabled" />
                            {%endif%}
                            <div class="fileUpload btn btn-primary">
                                <span>Choose File</span>
                                {{form.experience_photo_7}}
                            </div>
                            <br>
                            {%if form.files.experience_photo_8%}
                            <input id="uploadImage_8" placeholder="{{form.files.experience_photo_8.name}}" class="uploadImage" disabled="disabled" />
                            {%else%}
                            <input id="uploadImage_8" placeholder="No file chosen" class="uploadImage" disabled="disabled" />
                            {%endif%}
                            <div class="fileUpload btn btn-primary">
                                <span>Choose File</span>
                                {{form.experience_photo_8}}
                            </div>
                            <br>
                            {%if form.files.experience_photo_9%}
                            <input id="uploadImage_9" placeholder="{{form.files.experience_photo_9.name}}" class="uploadImage" disabled="disabled" />
                            {%else%}
                            <input id="uploadImage_9" placeholder="No file chosen" class="uploadImage" disabled="disabled" />
                            {%endif%}
                            <div class="fileUpload btn btn-primary">
                                <span>Choose File</span>
                                {{form.experience_photo_9}}
                            </div>
                            <br>
                            {%if form.files.experience_photo_10%}
                            <input id="uploadImage_10" placeholder="{{form.files.experience_photo_10.name}}" class="uploadImage" disabled="disabled" />
                            {%else%}
                            <input id="uploadImage_10" placeholder="No file chosen" class="uploadImage" disabled="disabled" />
                            {%endif%}
                            <div class="fileUpload btn btn-primary">
                                <span>Choose File</span>
                                {{form.experience_photo_10}}
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td class="coRight">&nbsp;</td>
                        <td colspan="2">
      	                    <input type="submit" name="button" id="big_button" value="Save" />
                        </td>
                    </tr>
                </table>
            </form>          
        </div>
    </div>
{% else %}
    <p> Please login first</p>
{% endif %}
</body>

<script charset="utf-8" type="text/javascript">

    $(document).ready(function(){
        //$("#repeat_frequency_label").text("Hours");
        $("#id_title").css("width", "100%");
        $("#id_summary").css("width", "100%");
        $("#id_summary").attr("cols", 45);
        $("#id_summary").attr("rows", 5);
        $("#id_price").css("width", "70px");
        $("#id_price_with_booking_fee").css("width", "70px");
        $("#id_activity").css("width", "100%");
        $("#id_interaction").css("width", "100%");
        $("#id_dress_code").css("width", "100%");
        $("#id_meetup_spot").css("width", "100%");
        $("#id_activity").attr("cols", 45);
        $("#id_interaction").attr("cols", 45);
        $("#id_dress_code").attr("cols", 45);
        $("#id_meetup_spot").attr("cols", 45);
        $("#id_activity").attr("rows", 5);
        $("#id_interaction").attr("rows", 5);
        $("#id_dress_code").attr("rows", 3);
        $("#id_meetup_spot").attr("rows", 5);

        for(i=1;i<11;i++)
        {
            $("#id_experience_photo_"+i).attr("class", "upload");

            $("#id_experience_photo_"+i).change(function(){
                string = $("#id_experience_photo_"+i).val();
                index=-1;
                index = string.lastIndexOf("\\");
                if(index==-1)
                {
                    index = string.lastIndexOf("/");
                }

                $("#uploadImage_"+i).val(string.substring(index+1));
            })
        }
    })

/*
    $("#id_repeat_cycle").change(function(){
        if($("#id_repeat_cycle").val().trim()=="Hourly")
        {
            $("#repeat_frequency_label").text('Hours');
        }
        else if($("#id_repeat_cycle").val().trim()=="Daily")
        {
            $("#repeat_frequency_label").text('Days');
        }
        else if($("#id_repeat_cycle").val().trim()=="Weekly")
        {
            $("#repeat_frequency_label").text('Weeks');
        }
        else
        {
            $("#repeat_frequency_label").text('Months');
        }
    })
*/


    $("#id_price").keyup(function()
    {
        var price = parseFloat($("#id_price").val());
        if(typeof price === 'number')
        {  
            $("#id_price_with_booking_fee").val((price*1.429*1.000+0.0).toFixed(2));
        }
    })


    $("#id_price_with_booking_fee").keyup(function()
    {
        var price = parseFloat($("#id_price_with_booking_fee").val());
        if(typeof price === 'number')
        {
            $("#id_price").val(((price-0.0)/(1.429*1.000)).toFixed(2));
        }
    })
</script>
</html>