<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Bookings</title>

{% load staticfiles %}
<link href="{% static 'custom_admin/css/globalReset.css' %}" rel="stylesheet" type="text/css" />
<link href="{% static 'custom_admin/css/browserStyle.css' %}" rel="stylesheet" type="text/css" />
<script language="javascript" type="text/javascript" src="{% static 'app/scripts/jquery-1.10.2.js' %}"></script>
<script language="javascript" type="text/javascript" src="{% static 'custom_admin/scripts/custom_admin.js' %}"></script>

</head>

<body>
{{time_changed_status}}
<div class="container">
  <div class="header">
    <div class="logo"><img src="/images/tripalocal_Logo.png" width="105" height="60" /></div>
    <ul class="menu"><li><a href="#">Experiences</a></li><li>Bookings</li>
    <li><a href="#">Payment</a></li></ul>
    <div class="account">Hi, Yiyi | <a href="#">Logout</a></div>
  </div>
  <div class="fullColumn">
    {% ifequal status 'success'%}
      <div class="notification" id="change_time_success_notification">Your manipulation is succeeded.</div>
    {% endifequal %}
    {% ifequal status 'failed'%}
      <div class="notification_red" id="change_time_failed_notification">Your manipulation is failed.</div>
  	{% endifequal %}

    <div class="operation"></div>
  	<ul class="subMenu">
    <li>Current Bookings</li>
    <li id="activated"><a href="/custom_admin/archive/">Archived</a></li>
   
    </ul>
    <div class="clear"></div>

<form id = "custom_admin_panel_table_form" action="/custom_admin/send_confirmation_email/" method="post"> 
  {% csrf_token %}
<table border="0" cellspacing="0" cellpadding="0">
    <tr>
    <td colspan="11" class="tableEdit">&nbsp;&nbsp;↓
<input name="input" type="button" value="Delete" onclick="deleteBookings()"/>&nbsp;&nbsp;
<input name="input" type="button" value="Email to Host" onclick="sendConfirmationEmailHost()"/>&nbsp;&nbsp;
<input name="input" type="button" value="Email to Traveller" onclick="sendConfirmationEmailGuest()"/>&nbsp;&nbsp;
<input name="input" type="button" value="Archive" onclick="archiveBookings()"/></td>
    </tr>
  <tr>
    <th scope="col"><span id="sprycheckbox1">
      <label>
        <input type="checkbox" name="checkbox1" id="checkbox1" value="all"/>
        </label>
      </span></th>
    <th scope="col"><p>Booking Time</p></th>
    <th scope="col">Experience Name</th>
    <th scope="col"  width="120">Host</th>
    <th scope="col"  width="120">Traveller</th>
    <th scope="col">Group Size</th>
    <th scope="col"> Status</th>
    <th scope="col"  width="120">Actions</th>

  </tr>
 
    {% for booking in booking_list %}
    {% if booking.status = 'requested' or booking.status = 'accepted' or booking.status = 'rejected' or booking.status = 'no_show' %}
      <tr>
        <td><input type="checkbox" name="admin_panel_booking_id_checkbox" value="{{booking.id}}"/></td>
        <td id="booking_date_time_booking_id_{{ booking.id }}" >{{ booking.datetime }}</td>
        <td><a href="#">{{ booking.experience.title }}</a></td>
        <td>
          {% for host in booking.experience.hosts.all %}
            <p>{{ host.first_name }}&nbsp;{{ host.last_name }}</p>
            <p>{{ host.registereduser.phone_number }}</p>
          {% endfor %}
        </td>
        <td>
          <p>{{ booking.user.first_name }}&nbsp;{{ booking.user.last_name }}</p>
          <p>{{ booking.user.registereduser.phone_number }}</p>
        </td>
        <td>{{ booking.guest_number }}</td>
        <td style="color:{{booking.colour}}">{{ booking.status_description }}</td>
        <td>
          {% for action in booking.actions %}
            {% ifequal action 'Change time'%}
              <p><a href="#" onclick="changeTime({{booking.id}})">{{action}}</a></p>
            {% endifequal %}

            {% ifequal action 'Mark as no show' %}
              <p><a href="/custom_admin/mark_as_no_show/{{booking.id}}">{{action}}</a></p>
            {% endifequal %}

            {% ifequal action 'Reopen booking' %}
              <p><a href="#" onclick = "reopenBooking({{ booking.id }})">{{action}}</a></p>
            {% endifequal %}
            
            {% ifequal action 'Cancel booking' %}
              <p><a href="#" onclick = "cancelBooking({{ booking.id }})">{{action}}</a></p>
            {% endifequal %}

            {% ifequal action 'Upload review' %}
              <p><a href="#" onclick = "uploadReview({{ booking.id }})">{{action}}</a></p>
            {% endifequal %}

          {% endfor %}
        </td>
    </tr>
    {% endif %}
    {% endfor %}
  
  </table>
</form>
  </div>


  <div class="push"></div>
</div>
<div class="footer">© TRIPALOCAL Pty Ltd. All Rights Reserved, 2014</div>


<div id="change_time_popup"style="display:none">
<form id = "change_time_form" action="/your-name/" method="post">
    {% csrf_token %}
<div id="light" class="white_content">
<div class="operation"><a href="#" onclick="closeChangeTimePopup()">Close</a></div>
<h1>Change time and date</h1>
<table border="0" cellspacing="0" cellpadding="0">
  <tr>
    <th scope="col">Booking ID.</th>
    <th scope="col">Date</th>
    <th scope="col">Time</th>
    </tr>
  <tr>
    <td id="booking_id_in_change_time_popup"></td>
    <td>
      {{ form.new_date }}
    </td>
    <td>
      {{ form.new_time }}
    </td>
    </tr>
</table>

  <div class="tableButton">
    <input type="submit" name="button" id="big_button" value="Update" />
  </div>
</div>
<div id="fade" class="black_overlay"></div>
</form>
</div>


<div id="upload_review_popup"style="display:none">
<form id = "upload_review_form" action="/your-name/" method="post">
    {% csrf_token %}
<div id="light" class="white_content">
<div class="operation"><a href="#" onclick="closeUploadReviewPopup()">Close</a></div>
<h1>Upload review</h1>
<div class="scroll"><table border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td class="coRight">&nbsp;</td>
      <td><h1>Leave review</h1>
        <p>After you have saved this review, it will be displayed on <a href="#">Italian Home Dining Experience</a> from Yiyi Wang.</p></td>
    </tr>
        <tr>
          <td class="coRight"></td>
      <td>
        {{ form2.review }}
        <br />
        {{ form2.rate }}
        <br />
      </td>
      </tr>
      </table>
</div>

  <div class="tableButton">
    <input type="submit" name="button" id="big_button" value="Submit Review" />
  </div>
</div>
<div id="fade" class="black_overlay"></div>
</form>
</div>



</body>
</html>
